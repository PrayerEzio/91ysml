<?phpnamespace App\Http\Service;use Qiniu\Auth;class QiniuService{    protected $access_key;    protected $secret_key;    public function __construct()    {        $this->access_key = env('QINIU_ACCESS_KEY');        $this->secret_key = env('QINIU_SECRET_KEY');    }    public function auth()    {        return new Auth($this->access_key,$this->secret_key);    }    public function getUploadToken($bucket = '')    {        $auth = $this->auth();        return $auth->uploadToken($bucket);    }    public function upload($file,$key = '')    {        if (!is_file($file) || !$file->isValid())        {            return false;        }        $bucket = 'crucis-cn';        $token = $this->getUploadToken($bucket);        $filePath = $file->getRealPath();        if (empty($key))        {            $file_name = Crypt::encrypt($file->getClientOriginalName());            $key = 'demo/'.$file_name.'.'.$file->getClientOriginalExtension();        }        $uploadManager = new UploadManager();        list($result['ret'],$result['error_msg']) = $uploadManager->putFile($token,$key,$filePath);        $file_qiniu_url = '';        if (empty($result['error_msg']))        {            $qiniu_domain = 'http://oslzmb9ex.bkt.clouddn.com/';            $file_qiniu_url = $qiniu_domain.$key;        }        return $file_qiniu_url;    }}